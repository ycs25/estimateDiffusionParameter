est<-function(Y) {
  
  g1=0;g2=0;g3=0;Z=X-1;
  for (t in 1:10000) {
    x1=Z[10*(t-1)+1]
    x2=Z[10*t+1]
    
    h1=sqrt((Y[1]+Y[2]+1)*Y[2]/Y[1])*(1+(Y[1]+Y[2])/Y[2]*x2)-exp(-Y[3]*0.01)*sqrt((Y[1]+Y[2]+1)*Y[2]/Y[1])*(1+(Y[1]+Y[2])/Y[2]*x1)
    
    g1=g1+h1
    
    h2=sqrt((Y[1]+Y[2]+3)*Y[2]*(Y[2]+1)*(Y[1]+Y[2])/Y[1]/(Y[1]+1)/2)*
      (1+2*(Y[1]+Y[2]+1)/Y[2]*x2+(Y[1]+Y[2]+1)*(Y[1]+Y[2]+2)/Y[2]/(Y[2]+1)*x2^2)-
      exp(-Y[3]*2*0.01*(Y[1]+Y[2]+1)/(Y[1]+Y[2]))*sqrt((Y[1]+Y[2]+3)*Y[2]*(Y[2]+1)*(Y[1]+Y[2])/Y[1]/(Y[1]+1)/2)*
      (1+2*(Y[1]+Y[2]+1)/Y[2]*x1+(Y[1]+Y[2]+1)*(Y[1]+Y[2]+2)/Y[2]/(Y[2]+1)*x1^2)
    
    g2=g2+h2
    
    h3=sqrt((Y[1]+Y[2]+5)*Y[2]*(Y[2]+1)*(Y[2]+2)*(Y[1]+Y[2])*(Y[1]+Y[2]+1)/Y[1]/(Y[1]+1)/(Y[1]+2)/6)*
      (1+3*(Y[1]+Y[2]+2)/Y[2]*x2+3*(Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)/Y[2]/(Y[2]+1)*x2^2+
         (Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)*(Y[1]+Y[2]+4)/Y[2]/(Y[2]+1)/(Y[2]+2)*x2^3)-
      exp(-Y[3]*3*0.01*(Y[1]+Y[2]+2)/(Y[1]+Y[2]))*sqrt((Y[1]+Y[2]+5)*Y[2]*(Y[2]+1)*(Y[2]+2)*(Y[1]+Y[2])*(Y[1]+Y[2]+1)/Y[1]/(Y[1]+1)/(Y[1]+2)/6)*
      (1+3*(Y[1]+Y[2]+2)/Y[2]*x1+3*(Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)/Y[2]/(Y[2]+1)*x1^2+
         (Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)*(Y[1]+Y[2]+4)/Y[2]/(Y[2]+1)/(Y[2]+2)*x1^3)
    
    g3=g3+h3
  }
  
  
  return(c(F1=g1,F2=g2,F3=g3))
}

library(rootSolve)
fs<-multiroot(est,c(1,1,1))
ss<-multiroot(est,c(3,5,1))

Y=c(3,5,1)
V=est(Y)