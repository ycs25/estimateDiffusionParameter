est<-function(Y) {
  
  g1=0;g2=0;g3=0;
  for (t in 1:10000) {
    x1=X[t]
    x2=X[t+1]
    h1=Y[2]+(Y[1]+Y[2])*(x2-1)-exp(-Y[3]*0.01)*(Y[2]+(Y[1]+Y[2])*(x1-1))
    g1=g1+h1
    
    h2=1/2*(Y[2]+1)*Y[2]+(Y[2]+1)*(Y[1]+Y[2]+1)*(x2-1)+
    1/2*(Y[1]+Y[2]+1)*(Y[1]+Y[2]+2)*(x2-1)^2-
    exp(-Y[3]*2*(Y[1]+Y[2]+1)/(Y[1]+Y[2])*0.01)*(1/2*(Y[2]+1)*Y[2]+(Y[2]+1)*(Y[1]+Y[2]+1)*(x1-1)+
    1/2*(Y[1]+Y[2]+1)*(Y[1]+Y[2]+2)*(x1-1)^2);
    g2=g2+h2;
    
    h3=1/6*Y[2]*(Y[2]+1)*(Y[2]+2)+1/2*(Y[2]+1)*(Y[2]+2)*(Y[1]+Y[2]+2)*(x2-1)+
    1/2*(Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)*(Y[2]+2)*(x2-1)^2+1/6*(Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)*(Y[1]+Y[2]+4)*(x2-1)^3-
    exp(-Y[3]*2*(Y[1]+Y[2]+1)/(Y[1]+Y[2])*0.01)*(1/6*Y[2]*(Y[2]+1)*(Y[2]+2)+1/2*(Y[2]+1)*(Y[2]+2)*(Y[1]+Y[2]+2)*(x1-1)+
    1/2*(Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)*(Y[2]+2)*(x1-1)^2+1/6*(Y[1]+Y[2]+2)*(Y[1]+Y[2]+3)*(Y[1]+Y[2]+4)*(x1-1)^3);
    g3=g3+h3;
  }
  
  
  return(c(F1=g1,F2=g2,F3=g3))
}

library(rootSolve)
fs<-multiroot(est,c(2,2,2))
ss<-multiroot(est,c(3,5,1))

Y=c(3,5,1)
V=est(Y)